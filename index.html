<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Live Location</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html, body { margin: 0; height: 100%; }
    #map { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const BIN_ID = "685bcd5b8960c979a5b10ee3";
    const ACCESS_KEY = "$2a$10$ILjBbVQboACduWRv7UGvj.tukJnCdHhlhg3kAi.e.S3NeCZCTb5/6";

    const map = L.map('map').setView([0, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    const marker = L.marker([0, 0]).addTo(map);

    function updateLocation() {
      fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { 'X-Access-Key': ACCESS_KEY }
      })
        .then(res => res.json())
        .then(data => {
          const { lat, lng } = data.record;
          if (lat && lng) {
            marker.setLatLng([lat, lng]);
            map.setView([lat, lng], 17);
          }
        })
        .catch(err => console.error("Fetch error", err));
    }

    setInterval(updateLocation, 5000);
    updateLocation();
  </script>
</body>
</html>
